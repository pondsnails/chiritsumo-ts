# GeminiæŒ‡æ‘˜äº‹é …ã¸ã®å¯¾å¿œçŠ¶æ³

## å„ªå…ˆåº¦1: è‡´å‘½çš„ãªãƒã‚°ã®ä¿®æ­£ï¼ˆå®Œäº†ï¼‰

### âœ… æ—¥ä»˜å‡¦ç†ã®UTC/JSTå•é¡Œ
**å•é¡Œ**: `new Date().toISOString().split('T')[0]` ã¯UTCåŸºæº–ã®æ—¥ä»˜ã‚’å–å¾—ã™ã‚‹ãŸã‚ã€æ—¥æœ¬ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ·±å¤œ0:00ã€œ9:00ã«æ“ä½œã™ã‚‹ã¨ã€Œå‰æ—¥ã€ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹ãƒã‚°

**ä¿®æ­£å†…å®¹**:
- `core/utils/dateUtils.ts` ã® `getTodayDateString()` ã¨ `formatDate()` ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿®æ­£
- ä¿®æ­£ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«:
  - `core/utils/dailyRollover.ts`
  - `core/utils/streakCalculator.ts`
  - `core/services/StudyTransactionService.ts`
  - `core/services/velocityService.ts`
  - `core/components/BrainAnalyticsDashboard.tsx`

**å½±éŸ¿**: ãƒ­ãƒ¼ã‚«ãƒ«ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³åŸºæº–ã§æ­£ç¢ºã«æ—¥ä»˜ãŒæ‰±ã‚ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã€æ·±å¤œå¸¯ã®ãƒã‚°ãŒè§£æ¶ˆ

### âœ… ChunkSizeSelectorã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å¼·åŒ–
**å•é¡Œ**: æ•°å€¤ä»¥å¤–ã®å…¥åŠ›ã‚„ä¸æ­£ãªå€¤ã«å¯¾ã™ã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãŒç”˜ã„

**ä¿®æ­£å†…å®¹**:
- åŽ³å¯†ãªæ•°å€¤ãƒã‚§ãƒƒã‚¯ï¼ˆNaNã€Infinityã€è² ã®æ•°ã€å°æ•°ã‚’å¼¾ãï¼‰
- ä¸Šé™å€¤ãƒã‚§ãƒƒã‚¯ï¼ˆ1000è¶…ãˆã‚’é˜²æ­¢ï¼‰
- ä¸æ­£å…¥åŠ›æ™‚ã¯ç¾åœ¨ã®å€¤ã«æˆ»ã™

---

## å„ªå…ˆåº¦2: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹æ”¹å–„ï¼ˆè¨ˆç”»ä¸­ï¼‰

### ðŸ“‹ SQLé›†è¨ˆå‡¦ç†ã¸ã®ç§»è¡Œï¼ˆæœªå®Ÿè£…ï¼‰
**å•é¡Œ**: `BrainAnalyticsDashboard` ãªã©ã§JSå´ã§ãƒ«ãƒ¼ãƒ—ã‚’å›žã—ã¦é›†è¨ˆå‡¦ç†

**è¨ˆç”»**:
- ãƒ’ãƒ¼ãƒˆãƒžãƒƒãƒ—: `SELECT date, COUNT(*) FROM cards WHERE last_review IS NOT NULL GROUP BY date`
- ä¿æŒçŽ‡è¨ˆç®—: SQLã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é–¢æ•°ã‚’æ´»ç”¨
- DBå´ã§è¨ˆç®—ã—ã€çµæžœã®ã¿JSã«è¿”ã™

### ðŸ“‹ ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å°Žå…¥ï¼ˆæœªå®Ÿè£…ï¼‰
**å•é¡Œ**: `cardStore.fetchCards()` ãŒå…¨ä»¶å–å¾—ï¼ˆ`SELECT * FROM cards`ï¼‰

**è¨ˆç”»**:
- ã‚«ãƒ¼ãƒ‰ä¸€è¦§ç”»é¢: FlatListã®`onEndReached`ã§ãƒšãƒ¼ã‚¸ãƒ³ã‚°
- Repositoryå±¤ã« `findPaginated(offset, limit)` ã‚’è¿½åŠ 
- åˆå›ž10ä»¶ã€ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§è¿½åŠ 20ä»¶ãšã¤å–å¾—

---

## å„ªå…ˆåº¦3: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ”¹å–„ï¼ˆè¨ˆç”»ä¸­ï¼‰

### ðŸ“‹ ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿæ§‹ã®åˆ·æ–°ï¼ˆæœªå®Ÿè£…ï¼‰
**å•é¡Œ**: `ensureSchema` ã§ã®æ‰‹å‹•DDLå®Ÿè¡Œã¯è„†ã„

**è¨ˆç”»**:
- `drizzle-kit` ã®ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”Ÿæˆæ©Ÿèƒ½ã‚’æ­£å¼å°Žå…¥
- ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
- ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã«æœªé©ç”¨ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•å®Ÿè¡Œ

### ðŸ“‹ JSONä¿å­˜ã®æ­£è¦åŒ–ï¼ˆæœªå®Ÿè£…ï¼‰
**å•é¡Œ**: `velocityService.ts` ãŒæ—¥ã€…ã®è¨ˆæ¸¬ãƒ‡ãƒ¼ã‚¿ã‚’JSONæ–‡å­—åˆ—ã§ä¿å­˜

**è¨ˆç”»**:
- `velocity_measurements` ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ
- ã‚«ãƒ©ãƒ : `date TEXT PRIMARY KEY, earned_lex INTEGER, target_lex INTEGER`
- SQLã§æœŸé–“é›†è¨ˆå¯èƒ½ã«

---

## å„ªå…ˆåº¦4: ã‚³ãƒ¼ãƒ‰å“è³ªå‘ä¸Šï¼ˆè¨ˆç”»ä¸­ï¼‰

### ðŸ“‹ åž‹å®‰å…¨æ€§ã®å¼·åŒ–ï¼ˆæœªå®Ÿè£…ï¼‰
- `backupService.ts` ã® `any` åž‹ã‚’å‰Šé™¤
- Zodã‚¹ã‚­ãƒ¼ãƒžã®åŽ³å¯†åŒ–

### ðŸ“‹ ç’°å¢ƒå¤‰æ•°ç®¡ç†ï¼ˆæœªå®Ÿè£…ï¼‰
- `subscriptionStore.ts` ã® `YOUR_IOS_API_KEY` ã‚’ `.env` ã§ç®¡ç†
- `expo-constants` çµŒç”±ã§æ³¨å…¥

---

## ã¾ã¨ã‚

### âœ… å®Œäº†ï¼ˆ2é …ç›®ï¼‰
1. æ—¥ä»˜å‡¦ç†ã®UTC/JSTå•é¡Œï¼ˆè‡´å‘½çš„ãƒã‚°ï¼‰
2. ChunkSizeSelectorã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

### ðŸš§ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
1. SQLé›†è¨ˆå‡¦ç†ã¸ã®ç§»è¡Œï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹æœ€é‡è¦ï¼‰
2. ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³å°Žå…¥ï¼ˆã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ï¼‰
3. ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿæ§‹ã®åˆ·æ–°ï¼ˆä¿å®ˆæ€§ï¼‰

### ðŸ“Š é€²æ—
- è‡´å‘½çš„ãƒã‚°ä¿®æ­£: **100%** âœ…
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹æ”¹å–„: **0%** ðŸ“‹
- ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ”¹å–„: **0%** ðŸ“‹
- ã‚³ãƒ¼ãƒ‰å“è³ª: **50%** (ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†)

---

**å„ªå…ˆé †ä½**: æ—¥ä»˜å‡¦ç† > SQLé›†è¨ˆ > ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ > ãƒžã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ > åž‹å®‰å…¨æ€§
